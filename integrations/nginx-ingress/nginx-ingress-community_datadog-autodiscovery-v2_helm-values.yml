# Reference to https://docs.nginx.com/nginx-ingress-controller/installation/installation-with-helm/

controller:
  # Needed for Datadog Nginx & Nginx Ingress integration
  pod:
    annotations:
      ad.datadoghq.com/nginx-ingress.logs: '[{"service": "controller", "source": "nginx-ingress-controller"}]'
      ad.datadoghq.com/nginx-ingress.checks: '{"nginx":{"instances":[{"nginx_status_url":"http://%%host%%:8080/stub_status"}]},"nginx_ingress_controller":{"instances":[{"prometheus_url":"http://%%host%%:9113/metrics","namespace":"nginx_ingress","metrics":[{"nginx_ingress_controller_ingress_resources_total":"controller.ingress_resources_total"},{"nginx_ingress_controller_nginx_last_reload_milliseconds":"controller.nginx_last_reload_milliseconds"},{"nginx_ingress_controller_nginx_last_reload_status":"controller.nginx_last_reload_status"},{"nginx_ingress_controller_nginx_reload_errors_total":"controller.nginx_reload_errors_total"},{"nginx_ingress_controller_nginx_reloads_total":"controller.nginx_reloads_total"},{"nginx_ingress_controller_nginx_worker_processes_total":"controller.nginx_worker_processes_total"},{"nginx_ingress_controller_virtualserver_resources_total":"controller.virtualserver_resources_total"},{"nginx_ingress_controller_virtualserverroute_resources_total":"controller.virtualserverroute_resources_total"},{"nginx_ingress_controller_workqueue_depth":"controller.workqueue_depth"},{"nginx_ingress_controller_workqueue_queue_duration_seconds_bucket":"controller.workqueue_queue_duration_seconds_bucket"},{"nginx_ingress_controller_workqueue_queue_duration_seconds_sum":"controller.workqueue_queue_duration_seconds_sum"},{"nginx_ingress_controller_workqueue_queue_duration_seconds_count":"controller.workqueue_queue_duration_seconds_count"},{"nginx_ingress_controller_workqueue_work_duration_seconds_bucket":"controller.workqueue_work_duration_seconds_bucket"},{"nginx_ingress_controller_workqueue_work_duration_seconds_sum":"controller.workqueue_work_duration_seconds_sum"},{"nginx_ingress_controller_workqueue_work_duration_seconds_count":"controller.workqueue_work_duration_seconds_count"},{"nginx_ingress_nginx_connections_accepted":"nginx.connections_accepted"},{"nginx_ingress_nginx_connections_active":"nginx.connections_active"},{"nginx_ingress_nginx_connections_handled":"nginx.connections_handled"},{"nginx_ingress_nginx_connections_reading":"nginx.connections_reading"},{"nginx_ingress_nginx_connections_waiting":"nginx.connections_waiting"},{"nginx_ingress_nginx_connections_writing":"nginx.connections_writing"},{"nginx_ingress_nginx_http_requests_total":"nginx.http_requests_total"},{"nginx_ingress_nginx_up":"nginx.up"}]}]}}'
  # Needed for Datadog Nginx & Nginx Ingress integration. Should restrict this to VPC subnet in actual use.
  nginxStatus:
    allowCidrs: 0.0.0.0/0
  enableLatencyMetrics: true
